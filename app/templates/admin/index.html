{% extends "app/layout.html" %}

{% block content %}
{% if user.is_superuser %}
<h1 class="page-header">
	Dashboard
</h1>
<div class="col-md-6 col-xs-12">
	<div class="panel panel-primary">
		<div class="panel panel-heading">
			<div id="float-left">
				Class Confidence
			</div>
			<div id="float-text-right">
				<button class="btn btn-default" onclick="minimize_panel('confidence-meter-panel', 'confidence-meter-btn');">
	                    <span id="confidence-meter-btn" class="glyphicon glyphicon-chevron-up"></span>
	            </button>
			</div>
		</div>
		<div class="panel panel-body" id="confidence-meter-panel">
			<div id="confidence-graph" style="width:100%;height:300px"></div>
		</div>
	</div>

	<div class="panel panel-primary">
		<div class="panel panel-heading">
			<div id="float-left">
				Quick Create Quiz
			</div>
			<div id="float-text-right">
				<button class="btn btn-default" onclick="minimize_panel('quick-quiz-panel', 'quick-quiz-btn');">
	                    <span id="quick-quiz-btn" class="glyphicon glyphicon-chevron-up"></span>
	            </button>
			</div>
		</div>
		<div class="panel panel-body" id="quick-quiz-panel">
			<div id="placeholder" style="width:100%;height:300px"></div>
		</div>
	</div>

	<div class="panel panel-primary">
		<div class="panel panel-heading">
			<div id="float-left">
				Quick Create Wordcloud
			</div>
			<div id="float-text-right">
				<button class="btn btn-default" onclick="minimize_panel('quick-wordcloud-panel', 'quick-wordcloud-btn');">
	                    <span id="quick-wordcloud-btn" class="glyphicon glyphicon-chevron-up"></span>
	            </button>
			</div>
		</div>
		<div class="panel panel-body" id="quick-wordcloud-panel">
			<div id="placeholder" style="width:100%;height:300px"></div>
		</div>
	</div>

</div>
<div class="col-md-6 col-xs-12">
	<div class="panel panel-primary">
		<div class="panel panel-heading">
			<div id="float-left">
				Quick Settings
			</div>
			<div id="float-text-right">
				<button class="btn btn-default" onclick="minimize_panel('quick-settings-panel', 'quick-settings-btn');">
	                    <span id="quick-settings-btn" class="glyphicon glyphicon-chevron-up"></span>
	            </button>
			</div>
		</div>
		<div class="panel panel-body" id="quick-settings-panel">
			
		</div>
	</div>

	<div class="panel panel-primary">
		<div class="panel panel-heading">
			<div id="float-left">
				Quiz Results Summaries
			</div>
			<div id="float-text-right">
				<button class="btn btn-default" onclick="minimize_panel('quiz-results-panel', 'quiz-results-btn');">
	                    <span id="quiz-results-btn" class="glyphicon glyphicon-chevron-up"></span>
	            </button>
			</div>
		</div>
		<div class="panel panel-body" id="quiz-results-panel">
			<div id="placeholder" style="width:100%;height:300px"></div>
		</div>
	</div>

	<div class="panel panel-primary">
		<div class="panel panel-heading">
			<div id="float-left">
				Quick Create Code Snippet
			</div>
			<div id="float-text-right">
				<button class="btn btn-default" onclick="minimize_panel('quick-code-panel', 'quick-code-btn');">
	                    <span id="quick-code-btn" class="glyphicon glyphicon-chevron-up"></span>
	            </button>
			</div>
		</div>
		<div class="panel panel-body" id="quick-code-panel">
			<div id="placeholder" style="width:100%;height:300px"></div>
		</div>
	</div>

</div>

{% endif %}

{% endblock %}

{% block scripts %}



<script type="text/javascript">

	function plot_confidence(data) {
	    flot_data = []
	    Object.keys(data).forEach(function (key) {
	    	var value = data[key]
	    	color = ''
	    	/* place in each if statement to prevent key 'current' from being in the graph */
	    	if (key=='good') {
	    		color="#5cb85c"
	    		flot_data.push({label: key, data: value, color: color})
	    	}
	    	if (key=='neutral') {
	    		color="#f0ad4e"
	    		flot_data.push({label: key, data: value, color: color})
	    	}
	    	if (key=='bad') {
	    		color="#d9534f"
	    		flot_data.push({label: key, data: value, color: color})
	    	}
	    });
		$.plot('#confidence-graph', flot_data, {
	    series: {
	        pie: {
	            show: true
	        	}
	    	}
	    });
	}
	
	var ping_interval = 100*15
    setInterval(function() {
        $.ajax({
	        type: "GET",
	        url:  "/poll/",
	        dataType: 'json',
	        success: function (data) {
	        	plot_confidence(data)
	        },
	        error: function(response){
	        },
    	});
        }, ping_interval
    )
</script>
{% endblock %}

{% block sidebar %}
    {% include "admin/sidebar.html" %}
{% endblock %}
