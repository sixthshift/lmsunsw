{% extends "app/layout.html" %}
{% load staticfiles %}
{% load crispy_forms_tags %}

{% block content %}
{% if user.is_superuser %}
<h1 class="page-header">
	Dashboard
</h1>
<div id="admin_alerts">
	<!--if there are any alerts, add them dynamically with js-->
</div>
<div class="col-md-6 col-xs-12">
	<div class="panel panel-primary">
		<div class="panel panel-heading">
			<div id="float-left">
				Class Confidence
			</div>
			<div id="float-text-right">
				<button class="btn btn-default" onclick="minimize_panel('confidence-meter-panel', 'confidence-meter-btn');">
	                    <span id="confidence-meter-btn" class="glyphicon glyphicon-chevron-up"></span>
	            </button>
			</div>
		</div>
		<div class="panel panel-body" id="confidence-meter-panel">
			<div id="confidence-graph" style="width:100%;height:300px"></div>
		</div>
	</div>

	<div class="panel panel-primary">
		<div class="panel panel-heading">
			<div id="float-left">
				Quick Create Quiz
			</div>
			<div id="float-text-right">
				<button class="btn btn-default" onclick="minimize_panel('quick-quiz-panel', 'quick-quiz-btn');">
	                    <span id="quick-quiz-btn" class="glyphicon glyphicon-chevron-up"></span>
	            </button>
			</div>
		</div>
		<div class="panel panel-body" id="quick-quiz-panel">
			<form method="post">
				<input type="hidden" name="csrfmiddlewaretoken" value='{{csrf_token}}'>
				{{ quick_quiz_form|crispy }}
				{{ quick_quiz_inline_form|crispy }}
				<div class="form_actions">
					<input type="submit" name="quiz" value="Submit" class="btn btn-primary" id="submit-id-quiz">
				</div>
			</form>
		</div>
	</div>

</div>
<div class="col-md-6 col-xs-12">
	<div class="panel panel-primary">
		<div class="panel panel-heading">
			<div id="float-left">
				Quick Settings
			</div>
			<div id="float-text-right">
				<button class="btn btn-default" onclick="minimize_panel('quick-settings-panel', 'quick-settings-btn');">
	                    <span id="quick-settings-btn" class="glyphicon glyphicon-chevron-up"></span>
	            </button>
			</div>
		</div>
		<div class="panel panel-body" id="quick-settings-panel">
			{% crispy quick_settings_form %}
		</div>
	</div>

	<div class="panel panel-primary">
		<div class="panel panel-heading">
			<div id="float-left">
				Quiz Results Summaries
			</div>
			<div id="float-text-right">
				<button class="btn btn-default" onclick="minimize_panel('quiz-results-panel', 'quiz-results-btn');">
	                    <span id="quiz-results-btn" class="glyphicon glyphicon-chevron-up"></span>
	            </button>
			</div>
		</div>
		<div class="panel panel-body" id="quiz-results-panel">
			{% for quiz in recent_quizzes %}
				<table class="table">
				{% for question, choices in quiz.items %}
					<thead>
						<tr>{{question}}</tr>
					</thead>
					<tbody>
						<tr>
						{% for choice in choices %}
							<td>{{choice}}</td>
						{% endfor %}
						</tr>
					</tbody>
				{% endfor %}
				</table>
			{% endfor %}
		</div>

	</div>

	<div class="panel panel-primary">
		<div class="panel panel-heading">
			<div id="float-left">
				Quick Create Code Snippet
			</div>
			<div id="float-text-right">
				<button class="btn btn-default" onclick="minimize_panel('quick-code-panel', 'quick-code-btn');">
	                    <span id="quick-code-btn" class="glyphicon glyphicon-chevron-up"></span>
	            </button>
			</div>
		</div>
		<div class="panel panel-body" id="quick-code-panel">
			{% crispy quick_codesnippet_form %}
		</div>
	</div>

</div>

{% endif %}

{% endblock %}

{% block scripts %}

	<script src="{% static 'app/scripts/admin_site.min.js' %}"></script>
	<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.min.js"></script>

<!--[if lte IE 8]><script language="javascript" type="text/javascript" src="/js/flot/excanvas.min.js"></script><![endif]-->   
    <script src="{% static 'app/scripts/flot/jquery.flot.pie.min.js' %}"></script>
	<script>
		function addQuickSelectHandlers() {
			$("#quick_lecture_select").change(function(data) {
				quick_update('lecture', this.options[this.selectedIndex].value, "{{csrf_token}}")
			});
			$("#quick_quiz_select").change(function(data) {
				quick_update('quiz', this.options[this.selectedIndex].value, "{{csrf_token}}")
			});

		}
		$(document).ready(addQuickSelectHandlers);
	</script>
	
{% endblock %}

{% block sidebar %}
    {% include "admin/sidebar.html" %}
{% endblock %}
